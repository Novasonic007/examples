<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Phaser 3.80 Examples</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="libs/bootstrap-4.0.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/index.css" />
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="libs/bootstrap-4.0.0/dist/js/bootstrap.min.js"></script>
    <script src="js/getQueryString.js"></script>
    <script src="js/phaserSearch.js"></script>
    <script src="js/lastExamplesButton.js"></script>

    <script src="https://cdn.usefathom.com/script.js" data-site="VHINKCRJ" defer></script>
</head>

<body>
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
        <a href="index.html"><img src="images/logo.png" width="144" height="31" /></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse ml-2" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item active">
                    <span id="breadcrumb-list">
                        <a class="breadcrumb-item" href="index.html">3.80 / Home</a>
                    </span>
                </li>
            </ul>
            <div class="form-inline my-2 my-lg-0">
                <button type="button" class="last-examples-btn btn my-2 my-sm-0" id="last-examples-button">
                    <b>Newest Examples</b>
                </button>
                <div class="search ml-sm-2">
                    <span>
                        <div id="last-examples-result">
                            <div class="last-examples-result--title">
                                Most Recently Added Examples
                            </div>
                            <div id="last-examples-result--content"></div>
                        </div>
                    </span>
                    <input placeholder="Search..." id="search-query" class="form-control" />
                    <div id="search-results" class="mt-2" style="display: block;right: 0px;"></div>
                </div>
            </div>
        </div>
    </nav>

    <div class="album ml-4 mr-4">
        <button class="btn backButton" id="backButton">
            <div class="button-box">
                <span class="button-elem">
                    <svg viewBox="0 0 46 40" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z">
                        </path>
                    </svg>
                </span>
                <span class="button-elem">
                    <svg viewBox="0 0 46 40">
                        <path
                            d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z">
                        </path>
                    </svg>
                </span>
            </div>
        </button>
        <div class="container-fluid mt-2">
            <div class="row" id="folderList"></div>
        </div>
    </div>

    <script type="text/javascript">
        var dir = "";
        var data = {};
        var folder = [];
        var trail = [];
        var well = [];
        var index = {};
        var currentCrumb = "";

        function openFolder() {
            $("#folderList").empty();

            var isBootable = false;

            $("#backButton").show();

            for (var i = 0; i < folder.length; i++) {
                var child = folder[i];

                if (child.name === "boot.json") {
                    isBootable = true;

                    break;
                }
            }

            if (isBootable) {
                createBootFile(i, child.name, child.path);
            } else {
                for (var i = 0; i < folder.length; i++) {
                    var child = folder[i];

                    if (child.hasOwnProperty("children")) {
                        createFolder(i, child.name, child.path);
                    }
                }

                for (var i = 0; i < folder.length; i++) {
                    var child = folder[i];

                    if (!child.hasOwnProperty("children")) {
                        createFile(i, child.name, child.path);
                    }
                }
            }

            //  Update browser history
            var stateObj = { well: well };
            history.pushState(stateObj, "", "index.html" + getURLWell());
        }

        function getURLWell(skipLast, add) {
            if (skipLast === undefined) {
                skipLast = false;
            }

            var output = "";
            var len = skipLast ? well.length - 1 : well.length;

            for (var i = 0; i < len; i++) {
                output = output.concat(encodeURI(well[i])) + "/";
            }

            if (add !== undefined) {
                output = output.concat(encodeURI(add)) + "/";
            }

            return "?dir=" + output + "&q=" + $("#search-query").val();
        }

        function addBreadcrumb(filename) {
            var nav = $("<a></a>", {
                class: "breadcrumb-item",
                href: "index.html" + getURLWell(),
            }).text(filename);

            currentCrumb = filename;

            $("#breadcrumb-list").append(nav);
        }

        function removeBreadcrumb() {
            $("#breadcrumb-list > a").last().remove();
        }

        function downLevel(index, filename, skipOpen) {
            if (skipOpen === undefined) {
                skipOpen = false;
            }

            if (!folder[index].hasOwnProperty("children")) {
                // console.log('No children, aborting');
                return;
            }

            //  Record the trail
            trail.push(folder);

            folder = folder[index].children;

            well.push(filename);

            addBreadcrumb(filename);

            if (!skipOpen) {
                openFolder();
            }
        }

        function upLevel() {
            removeBreadcrumb();

            if (trail.length === 1) {
                createTopLevelFolders();
            } else {
                folder = trail[trail.length - 1];

                trail.pop();

                well.pop();

                openFolder();
            }
        }

        function createBootFile(index, filename, filepath) {
            var div = $("<div></div>").addClass("card col-xl-2 col-12");

            var a = $("<a></a>", { href: "boot.html?src=" + filepath });

            const imgPath = filepath
                .replace(/^src/, "screenshots")
                .replace(/\.json$/, ".png")
                .replace(/\.js$/, ".png");
            var img = $("<img />", {
                src: imgPath,
                width: 240,
                height: 180,
            });

            a.append(img);

            var p = $("<p></p>").addClass("card-text").text(currentCrumb);

            div.append(a).append(p);

            $("#folderList").append(div);
        }

        function createFile(index, filename, filepath) {
            if (filename.substr(0, 1) === "_") {
                return;
            }

            var fileContainer = $("<div></div>").addClass(
                "d-flex justify-content-center p-2 col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"
            );
            var div = $("<div></div>").addClass(
                "card h-100 align-items-center"
            );

            const url = (dir === "scalemanager/")
                ? "100.html?src=" + filepath
                : "view.html?src=" + filepath;

            const imgPath = filepath
                .replace(/^src/, "screenshots")
                .replace(/\.json$/, ".png")
                .replace(/\.js$/, ".png")
                .toLowerCase();

            var imgdiv = $("<div class='card-img-top'></div>").addClass(
                "imageHolder"
            );

            var img1 = $("<img />", {
                src: "screenshots/loading.png",
                width: 400,
                height: 300,
                class: "card-image shot2 p-3",
            });
            var img2 = $("<img />", {
                src: imgPath,
                width: 400,
                height: 300,
                class: "card-image shot1 p-3",
            });

            imgdiv.append(img1);
            imgdiv.append(img2);

            div.append(imgdiv);

            var cardBody = $("<div></div>").addClass("card-body");
            var p = $("<p></p>").addClass("card-text");

            p.append(
                $("<a></a>", { href: "edit.html?src=" + filepath }).text(
                    filename.replace(".js", "")
                )
            );
            cardBody.append(p);
            div.append(cardBody);
            fileContainer.append(div);

            // Add click event to the card
            div.on("click", function () {
                window.location.href = url;
            });

            $("#folderList").append(fileContainer);
        }

        function createFolder(index, filename, filepath) {
            if (filename === "archived" || filename.substr(0, 1) === "_") {
                return;
            }

            var folderContainer = $("<div></div>").addClass(
                "d-flex justify-content-center p-2 col-xs-12 col-sm-6 col-md-4 col-lg-3 col-xl-2"
            );
            var div = $("<div></div>").addClass(
                "card h-100 align-items-center"
            );

            var a = $("<a></a>", {
                href: "index.html" + getURLWell(false, filename),
            });

            var img = $("<img />", {
                src: "images/phaser-folder.png",
                width: 128,
                height: 128,
            });

            div.click(function (event) {
                downLevel(index, filename);
            });

            a.append(img);

            var cardBody = $("<div></div>").addClass("card-body");
            var p = $("<p></p>").addClass("card-text");

            p.append(
                $("<a></a>", {
                    href: "index.html" + getURLWell(false, filename),
                }).text(filename)
            );
            cardBody.append(p);

            div.append(a).append(cardBody);
            folderContainer.append(div);

            $("#folderList").append(folderContainer);
        }

        function createTopLevelFolders() {
            $("#folderList").empty();

            trail = [];
            well = [];
            folder = data.children;

            for (var i = 0; i < folder.length; i++) {
                createFolder(i, folder[i].name, folder[i].path);
            }
        }

        function loadFolders(param) {
            trail = [];
            well = [];
            folder = data.children;

            var dirs = [];
            var raw = param.split("/");

            for (var i = 0; i < raw.length; i++) {
                raw[i] = decodeURI(raw[i]);

                if (raw[i] !== "") {
                    dirs.push(raw[i]);
                }
            }

            var current = data.children;

            dirs.forEach(function (level) {
                for (i = 0; i < current.length; i++) {
                    if (current[i].name === level) {
                        downLevel(i, current[i].name, true);

                        current = current[i].children;

                        break;
                    }
                }
            });

            openFolder();
        }

        $(document).ready(function () {
            $("#backButton").hide();

            PHASER.search.initialize();

            $.getJSON("examples.json", function (json) {
                data = json;

                dir = getQueryString("dir");

                var q = getQueryString("q");

                $("#search-query").val(q);

                if (q) {
                    search(q);
                }

                if (dir) {
                    loadFolders(dir);
                } else {
                    createTopLevelFolders();
                }
            });
        });

        $("#backButton").click(function () {
            window.location = "index.html" + getURLWell(true);
        });
    </script>

    <!--
     This is the template for rendering search box results
     -->
    <script type="text/template" id="result-row-template">
        <div class="result p-2 mb-2">
            <a href="{{fullPath}}" class="result-title d-block mb-1">
                {{title}}
            </a>
            <a href="?dir={{path}}" class="result-path d-block">
                {{path}}
            </a>
        </div>
    </script>
       
</body>

</html>